//
//
//

const Game_schema = require('core/game_schema');

function load(game_path, game_name, cb) {

  cb = cb || function() {};

  let game = require(game_path);

  if (!game || !game.db_init || !game.db_init.name || !game.init || !game.turn || !game.config) {
    console._log(`not valid game => ${game.db_init.game_name}`);
    return cb({
      status: 400,
      err: new Error('no valid game.')
    })
  }

  let schema = game.db_init;
  schema.path = game_path;

  Game_schema.add(schema, function(err, result) {

    if (err) {
      return cb({
        status: 500,
        err: err
      });
    }

    Game_schema.load_to_RAM(game, game.db_init.name, function(err) {
      if (err) {
        return cb(err);
      }

      console._log(`game loaded => ${game.db_init.name}`);

      return cb(null, result);
    });
  });
}

module.exports = load;
